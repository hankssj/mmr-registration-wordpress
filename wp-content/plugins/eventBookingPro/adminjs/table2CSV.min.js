(function(A){A(function(){A.fn.table2CSV=function(L){var L=jQuery.extend({separator:",",header:[],delivery:"popup"},L);var J=[];var B=[];var E=this;var F=L.header.length;var K=[];if(F>0){for(var I=0;I<F;I++){K[K.length]=D(L.header[I])}}else{A(E).filter(":visible").find("th").each(function(){if(A(this).css("display")!="none"){K[K.length]=D(A(this).html())}})}H(K);A(E).find("tr").each(function(){var M=[];A(this).filter(":visible").find("td").each(function(){if(A(this).css("display")!="none"){M[M.length]=D(A(this).html())}});H(M)});if(L.delivery=="popup"){var G=J.join("\n");return C(G)}else{var G=J.join("\n");return G}function H(M){var O=M.join("");if(M.length>0&&O!=""){var N=M.join(L.separator);J[J.length]=N}}function D(N){var O=new RegExp(/["]/g);var M=N.replace(O,"â€œ");var O=new RegExp(/\<[^\<]+\>/g);var M=M.replace(O,"");if(M==""){return""}return'"'+M+'"'}function C(M){var N=window.open("","csv","height=400,width=600");N.document.write("<html><head><title>CSV</title>");N.document.write("</head><body >");N.document.write('<textArea cols=70 rows=15 wrap="off" >');N.document.write(M);N.document.write("</textArea>");N.document.write("</body></html>");N.document.close();return true}}})}(jQuery));